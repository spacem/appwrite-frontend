# Project context for AI tools

This repository is a Vite + React + TypeScript SPA that implements Appwrite authentication with multiple providers and i18n.

- Stack: Vite (SWC) + React + TypeScript
- Auth: Appwrite Web SDK (Account, Client, ID) with:
  - Email/password, Magic Link, OTP (email/phone), Anonymous
  - OAuth via token flow (createOAuth2Token + createSession using userId/secret)
- Theming: CSS variables with light/dark themes. Root sets `data-theme` to `dark|light`.
- i18n: Custom provider in `src/i18n/index.tsx` with locale maps in `src/i18n/locales/*`. Use `const { t, lang, setLang } = useI18n()` and call `t('key')` for all user-facing strings. Add new keys to `en.ts` first, then other locales.
- UI: Centered sheet with provider-style buttons; Privacy Policy and Terms modals are deep-linkable via `?legal=privacy|tos`.
- Env: Configure Appwrite via Vite env vars: `VITE_APPWRITE_ENDPOINT`, `VITE_APPWRITE_PROJECT_ID`.

Conventions
- Use TypeScript everywhere and keep props typed.
- All visible text must be translated using `t()` and keys added to locales.
- Maintain accessibility: buttons have clear labels, error banners use `role="alert"`, notices use `role="status"`.
- Keep theme consistent: honor `data-theme` and avoid hardcoded colors; prefer CSS vars.
- For OAuth, prefer the token flow. Handle `userId`/`secret` query params and clear them from the URL after use.
- For anonymous login, log out existing session first to avoid the active-session error.

Quick paths
- Appwrite client: `src/lib/appwrite.ts`
- Root app: `src/App.tsx`
- Auth page: `src/pages/AuthPage.tsx`
- Email/password form: `src/components/auth/EmailPasswordForm.tsx`
- Providers: `src/components/auth/ProviderButtons.tsx`
- Legal content: `src/components/legal/LegalContent.tsx`

Testing
- Vitest + React Testing Library are set up. Prefer component tests for auth flows, covering happy path and 401/validation edge cases.

Notes for AI tools
- Do not add raw secrets. Use Vite env vars and document required values.
- Prefer minimal changes per PR; keep unrelated formatting intact.
- When adding new visible strings, update all locales or provide English fallback.
